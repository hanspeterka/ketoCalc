{% extends "base.html.j2" %}
{% block title %}
    Uživatel
{% endblock %}

{% block style %}{% endblock %}

{% block script %}
    <script type="text/javascript">
        function validateRegister(){
            if ($(".password").val().length < 8){
                bootbox.alert("Heslo je příliš krátké!");
                return false
            }
            else {
              return true  
            }
        }

        $(document).on('blur','.password',function(){
            if ($(this).val().length > 8){
                $(".wrongPassword").empty();
            } else {
                $(".wrongPassword").empty();
                $(".wrongPassword").append("<small class='form-text'>Heslo je příliš krátké!</small>");
            }

        });

        function toggleVisibility() {
            var x = $('#password')
            if (x.attr("type") === "password"){
                x.attr("type", 'text');
            } else {
                x.attr("type", 'password');
            }
        }

    </script>
{% endblock %}

{% block content %}
    <div class="container">
        <div class="col-12">
            <form action="{{ url_for('UsersView:post', page_type='edit') }}" class="form-group" method="post" accept-charset="utf-8">
                <table class="table">
                    <thead>
                        <tr>
                            <th scope="col">{{ texts.user_username}}</th>
                            <th scope="col">{{ texts.user_firstname}}</th>
                            <th scope="col">{{ texts.user_lastname}}</th>
                            <th scope="col"></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                {{ user.username }}
                            </td>
                            <td>
                                <input name="firstname" type="text" class="form-control" value="{{ user.first_name }}"/>
                            </td>
                            <td>
                                <input name="lastname" type="text" class="form-control" value="{{ user.last_name }}"/>
                            </td>
                            <td>
                                <input type="submit" class="btn btn-warning float-right" value="{{ texts.edit_confirm }}" />
                            </td>
                        </tr>
                    </tbody>
                </table>
            </form>

            <form action="{{ url_for('UsersView:post', page_type='change_password')}}" method="post" onsubmit="return validateRegister()" >
                <table class="table">
                    <td>
                        <input id="password" name="password" type="password" class="form-control password" placeholder="{{ texts.password_new }}" />
                        <span class="wrongPassword" style="color: var(--color_warning);"></span>
                    </td>
                    <td>
                        <input type="button" class="btn" onclick="toggleVisibility()" value="{{ texts.password_show }}">
                    </td>
                    <td>
                        <input type="submit" class="btn btn-warning float-right" value="{{ texts.password_change }}">
                    </td>
                </table>
            </form>
        </div>

        <div>
            <a href="{{ url_for('UsersView:show')) }}" class="btn btn-secondary">{{ texts.edit_cancel}} {{ icons.edit }}</a>
        </div>
    </div>
{% endblock %}

